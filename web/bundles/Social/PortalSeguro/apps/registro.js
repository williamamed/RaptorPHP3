/* 
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

var app = angular.module("myApp", ["ngRoute"]);

app.config(function($routeProvider, $locationProvider, $httpProvider) {


    $httpProvider.interceptors.push(function($q, $location) {
        return {
            'request': function(config) {

                config.headers['X-Requested-With'] = 'XMLHttpRequest'
                UIR.load.show('Cargando....')
                return config;
            },
            'responseError': function(rejection) {
                
                UIR.load.hide()
                if (!rejection.config.ignoreRequest && rejection.status == 404)
                    $location.path('/404')
                if (!rejection.config.ignoreRequest && rejection.status == 401){
                    UIR.load.show('Autenticaci√≥n detectada, redireccionando....')
                    window.location.href=Raptor.getRoute('/syntarsus/login?redirect=' + window.encodeURIComponent(document.URL))
                    return;
                }
                
                return $q.reject(rejection);
            },
            'response': function(response) {
                // same as above
                UIR.load.hide()
                return response;
            }
        };
    });

    $routeProvider
            .when("/", {
                template: '<div class="starter-template">' +
                        '<div class="starter-template">' +
                        '<input class="form-control" type="text" ng-model="nombre" placeholder="type something here ..">' +
                        '<h1>Angular - Bootstrap starter template,{{ nombre }}</h1>' +
                        '<p class="lead">Use this document as a way to quickly start any new project.<br> All you get is this text and a mostly barebones HTML document.<br>Generated by Raptor 3</p>' +
                        '</div>' +
                        '</div>'
            })
            .when("/plataforma/registro", {
                templateUrl: "site/platform/register",
                controller: "platformCtrl"
            })
            .when("/plataforma/configuracion", {
                templateUrl:  "site/platform/configure"
            })
            .when("/blue", {
                templateUrl: "blue.htm"
            })
            .when('/404', {
                template: "<h1>404</h1><p class='text-center'>La pagina solicitada no existe</p>"
            })
            .otherwise({redirectTo: '/404'});


});


